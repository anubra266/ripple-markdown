
import { codeToHtml } from 'https://esm.sh/shiki@3.0.0'

import { cn } from '../lib/utils'
import { track, effect } from 'ripple'

export component Code(props) {
	const [code, rest] = track(props, {split: ['code']});

	const divRef = async (node) => {
		const html = await codeToHtml(@code, {
			theme: 'vitesse-dark',
			lang: @rest.language,
		});
		node.innerHTML = html;
	};
    
    <div {ref divRef} {...@rest} class={cn("[&>pre]:!bg-transparent text-sm", @rest.class)}  />
}